---
import Layout from '../layouts/Layout.astro';
let songList = [
    { title: "Heavenly Peace", artist: "Don Meon", album: "Divine Melodies", duration: "3:45" },
    { title: "Soulful Journey", artist: "Don Meon", album: "Spiritual Vibes", duration: "4:20" },
    { title: "Eternal Light", artist: "Don Meon", album: "Celestial Tunes", duration: "5:10" },
];
---

<Layout title="Enjoy soul lifting songs from Don Meon">
   
   <section class="main2">

    <h1>Playlist</h1>

    <ul id="playlist">
    {songList.map((song) => (
        <li>
            <strong>{song.title}</strong> by {song.artist} from the album
            <em>{song.album}</em> - {song.duration}
        </li>
    ))}
    </ul>

    <button id="shuffleBtn">Shuffle songs</button>

<!-- Add Song Form -->
<form id="add-song-form">
    <input type="text" id="new-song-title" placeholder="Add a new song title" required />
    <button type="submit">Add Song</button>
</form>

    </div>
    </section>
        
<script>
    // Convert initial playlist to array of <li> elements
    const items = Array.from(document.querySelectorAll("#playlist li"));

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    // SHUFFLE BUTTON
    document.getElementById("shuffleBtn").addEventListener("click", () => {
        const list = document.getElementById("playlist");
        shuffleArray(items);
        list.innerHTML = "";
        items.forEach((item) => list.appendChild(item));
    });

    // ADD NEW SONG
    const form = document.getElementById("add-song-form");

    form.addEventListener("submit", function (event) {
        event.preventDefault(); // prevent page reload

        const input = document.getElementById("new-song-title");
        const newSongTitle = input.value.trim();

        if (newSongTitle !== "") {
            const list = document.getElementById("playlist");

            // Create <li> for new song
            const li = document.createElement("li");
            li.textContent = newSongTitle;

            // Add to displayed list
            list.appendChild(li);

            // Also add to array so shuffle still works
            items.push(li);

            // Clear input
            input.value = "";
        }
    });
</script>
</Layout>